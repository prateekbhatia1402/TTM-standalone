CREATE DATABASE IF NOT EXISTS TTMPRATEEKv2;
USE TTMPRATEEKv2;
SET FOREIGN_KEY_CHECKS = 0;
DROP TABLE IF EXISTS `student`;
DROP TABLE IF EXISTS `faculty`;
DROP TABLE IF EXISTS `time slot`;
DROP TABLE IF EXISTS `room`;
DROP TABLE IF EXISTS `parent details`;
DROP TABLE IF EXISTS `subject`;
DROP TABLE IF EXISTS `account`;
DROP TABLE IF EXISTS `class`;
DROP TABLE IF EXISTS `class_subject_faculty`;
DROP TABLE IF EXISTS `day`;
DROP TABLE IF EXISTS `schedule`;
DROP TABLE IF EXISTS `admin`;
SET FOREIGN_KEY_CHECKS = 1;

CREATE TABLE `student` (
    `REGISTRATION ID` VARCHAR(6) NOT NULL,
    `STUDENT NAME` VARCHAR(20) NOT NULL,
    `EMAIL` VARCHAR(35) NOT NULL,
    `USERNAME` VARCHAR(20) NOT NULL,
    `MOBILE NUMBER` VARCHAR(10) NOT NULL,
    `CLASS` VARCHAR(6) NULL,
    `PERMANENT Address` VARCHAR(60) NOT NULL,
    `CORR. ADDRESS` VARCHAR(60) NOT NULL,
    `ROLL NUMBER` INTEGER NOT NULL,
    `DATE OF BIRTH` DATE NOT NULL,
    `DATE OF REGISTRATION` DATE NOT NULL,
    `GENDER` CHAR(1) NOT NULL,
    `BLOOD GROUP` VARCHAR(3) NULL,
    `PARENT ID` VARCHAR(10),
    PRIMARY KEY (`REGISTRATION ID`)
);

CREATE TABLE `faculty` (
    `FACULTY ID` VARCHAR(10) NOT NULL,
    `NAME` VARCHAR(20) NOT NULL,
    `EMAIL` VARCHAR(35) NOT NULL,
    `USERNAME` VARCHAR(20) NOT NULL,
    `PERMANENT ADDRESS` VARCHAR(60) NOT NULL,
    `CORR. ADDRESS` VARCHAR(60) NOT NULL,
    `DATE OF BIRTH` DATE NOT NULL,
    `DATE OF REGISTRATION` DATE NOT NULL,
    `MOBILE NUMBER` VARCHAR(10) NOT NULL,
    `GENDER` CHAR(1) NOT NULL,
    `BLOOD GROUP` VARCHAR(3) NOT NULL,
    `EXPERIENCE` VARCHAR(50) NOT NULL,
    `SUBJECT SPECIALITY` VARCHAR(25) NOT NULL,
    PRIMARY KEY (`FACULTY ID`)
);

CREATE TABLE `time slot` (
    `ID` VARCHAR(10) NOT NULL,
    `FROM` VARCHAR(4) NOT NULL,
    `TO` VARCHAR(4) NOT NULL,
    PRIMARY KEY (`ID`)
);

CREATE TABLE `room` (
    `ID` INTEGER NOT NULL,
    `SITTING CAPACITY` INTEGER NOT NULL,
    PRIMARY KEY (`ID`)
);

CREATE TABLE `parent details` (
    `PARENT ID` VARCHAR(10) NOT NULL,
    `STUDENT REGISTRATION ID` VARCHAR(6) NOT NULL,
    `FATHER NAME` VARCHAR(20) NOT NULL,
    `FATHER EMAIL ID` VARCHAR(35) NOT NULL,
    `FATHER MOBILE NUMBER` VARCHAR(10) NOT NULL,
    `FATHER DOB` DATE NULL,
    `MOTHER NAME` VARCHAR(20) NOT NULL,
    `MOTHER EMAIL` VARCHAR(35) NOT NULL,
    `MOTHER MOBILE NUMBER` VARCHAR(10) NOT NULL,
    `MOTHER DOB` DATE NULL,
    `FAMILY INCOME` VARCHAR(21) NOT NULL,
    PRIMARY KEY (`PARENT ID`)
);

CREATE TABLE `subject` (
    `SUBJECT ID` VARCHAR(10) NOT NULL,
    `SUBJECT NAME` VARCHAR(25) NOT NULL,
    `LECTURES REQUIRED` INTEGER,
    PRIMARY KEY (`SUBJECT ID`)
);

CREATE TABLE `account` (
    `USERNAME` VARCHAR(20) NOT NULL,
    `PASSWORD` VARCHAR(20) NOT NULL,
    `ROLE` VARCHAR(10) NOT NULL,
    PRIMARY KEY (`USERNAME`)
);

CREATE TABLE `class` (
    `ID` VARCHAR(6) NOT NULL,
    `NAME` VARCHAR(20) UNIQUE NOT NULL,
    `ROOM ID` INTEGER,
    PRIMARY KEY (`ID`)
);

CREATE TABLE `class_subject_faculty` (
    `ID` INTEGER NOT NULL  auto_increment,
    `CLASS ID` VARCHAR(6) NOT NULL,
    `FACULTY ID` VARCHAR(10) NOT NULL,
    `SUBJECT ID` VARCHAR(10) NOT NULL,
    `ROOM ID` INTEGER NULL,
    PRIMARY KEY (`ID`)
);

CREATE TABLE `day` (
    `DAY ID` CHAR(2) NOT NULL,
    `DAY NAME` VARCHAR(10) NOT NULL,
    `DAY NUMBER` INTEGER(1) NOT NULL,
    PRIMARY KEY (`DAY ID`)
);

CREATE TABLE `schedule` (
    `SCHEDULE ID` int not null auto_increment ,
    `LAST UPDATED` DATE,
    `WEF` DATE NOT NULL,
    `DAY ID` CHAR(2) NOT NULL,
    `TIMESLOT ID` VARCHAR(10) NOT NULL,
    `CLASS ID` VARCHAR(6) NOT NULL,
    `SUBJECT ID` VARCHAR(10) NOT NULL,
    `FACULTY ID` VARCHAR(10) NOT NULL,
    `ROOM ID` INTEGER,
    PRIMARY KEY (`SCHEDULE ID`)
);

CREATE TABLE `schedule_records` (
    `SCHEDULE ID` INT not null auto_increment,
    `TIME TABLE ID` VARCHAR(10) NOT NULL,
    `FROM` DATE,
    `TO` DATE,
    `DAY ID` CHAR(2) NOT NULL,
    `TIMESLOT ID` VARCHAR(10) NOT NULL,
    `CLASS ID` VARCHAR(6) NOT NULL,
    `SUBJECT ID` VARCHAR(10) NOT NULL,
    `FACULTY ID` VARCHAR(10) NOT NULL,
    `ROOM ID` INTEGER,
    PRIMARY KEY (`SCHEDULE ID`)
);

CREATE TABLE `admin` (
    `ID` INTEGER NOT NULL auto_increment,
    `NAME` VARCHAR(20) NOT NULL,
    `EMAIL` VARCHAR(35) NOT NULL,
    `PHONE NUMBER` VARCHAR(10) NOT NULL,
    `USERNAME` VARCHAR(20) NOT NULL,
    `TYPE` VARCHAR(10) NOT NULL,
    PRIMARY KEY (`ID`)
);

CREATE TABLE `qualification` (
    `FACULTY ID` VARCHAR(10) NOT NULL,
    `DEGREE` VARCHAR(10) NOT NULL,
    `YEAR` CHAR(4) NOT NULL,
    `INSTITUTE` VARCHAR(20)NOT NULL,
    `PERCENTAGE` DECIMAL(5,2)
);
# ALTER TABLE `student` ADD FOREIGN KEY (`CLASS`) REFERENCES `CLASS`(`ID`);
ALTER TABLE `parent details` ADD FOREIGN KEY (`STUDENT REGISTRATION ID`) REFERENCES `student`(`REGISTRATION ID`) ON DELETE cascade;
ALTER TABLE `qualification` ADD FOREIGN KEY (`FACULTY ID`) REFERENCES `faculty`(`FACULTY ID`);
ALTER TABLE `class` ADD FOREIGN KEY (`ROOM ID`) REFERENCES `room`(`ID`) ON DELETE set NULL;
